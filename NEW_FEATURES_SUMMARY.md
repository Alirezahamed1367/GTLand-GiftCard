# خلاصه قابلیت‌های جدید - Professional Grid
==========================================

## ✅ قابلیت‌های اضافه شده:

### 1. شخصی‌سازی ستون‌ها ⚙️
**مسیر دسترسی:**
```
گزارش حرفه‌ای → دکمه "⚙️ شخصی‌سازی ستون‌ها"
```

**امکانات:**
- ✅ انتخاب ستون‌های نمایشی (چک‌باکس)
- ⬆️⬇️ تغییر ترتیب ستون‌ها
- ✅❌ انتخاب/حذف همه
- 💾 ذخیره تنظیمات (در `data/financial/grid_config.json`)
- 🔄 بازگردانی به پیش‌فرض

**ستون‌های قابل انتخاب:**
- Label (کد آکانت)
- Email
- تأمین‌کننده  
- خرید (Gold)
- نرخ خرید
- هزینه خرید
- جمع فروش
- درآمد کل
- سود/زیان
- درصد سود
- موجودی Gold
- موجودی Silver

---

### 2. ستون‌های Platform 🎮
**تنظیمات:**
- ☑️ نمایش/مخفی کردن ستون‌های Platform
- استخراج خودکار از داده‌های فروش
- برای هر Platform: 2 ستون (مقدار + درآمد)

**مثال Platforms:**
- Roblox → مقدار فروش | درآمد فروش
- Apple → مقدار فروش | درآمد فروش
- Steam → مقدار فروش | درآمد فروش

---

### 3. ستون‌های محاسباتی (فرمول) 🧮

**مسیر:**
```
شخصی‌سازی ستون‌ها → بخش "ستون‌های محاسباتی" → "➕ افزودن فرمول"
```

**ویژگی‌ها:**
- ➕ افزودن فرمول جدید
- ✏️ ویرایش فرمول موجود
- 🗑️ حذف فرمول
- 🧮 محاسبه خودکار برای هر سطر
- 📊 فرمت‌های نمایش: عدد، مبلغ، درصد

**متغیرهای قابل استفاده:**
```javascript
{label}            // کد آکانت
{gold_purchased}   // مقدار خرید
{purchase_rate}    // نرخ خرید
{purchase_cost}    // هزینه خرید
{total_sold}       // جمع فروش
{total_revenue}    // درآمد کل
{total_profit}     // سود کل
{profit_pct}       // درصد سود
{remaining_gold}   // موجودی Gold
{remaining_silver} // موجودی Silver
```

**عملگرها:**
```
+  -  *  /  ( )
```

**مثال‌های کاربردی:**

1. **سود به ازای هر Gold:**
   ```
   {total_profit} / {gold_purchased}
   ```

2. **مارجین سود:**
   ```
   ({total_revenue} - {purchase_cost}) / {total_revenue} * 100
   ```

3. **قیمت فروش متوسط:**
   ```
   {total_revenue} / {total_sold}
   ```

4. **سود خالص (با کسر 10% کمیسیون):**
   ```
   {total_profit} * 0.9
   ```

5. **نسبت فروش به خرید:**
   ```
   {total_sold} / {gold_purchased} * 100
   ```

---

## 🎯 مسیر دسترسی کامل:

### از منوی اصلی:
```
1. اجرای برنامه GT-Land
   ↓
2. تب "🔄 مدیریت BI"
   ↓
3. بخش "📊 گزارش حرفه‌ای"
   ↓
4. دکمه "📊 نمایش گزارش Excel-like"
   ↓
5. پنجره گزارش باز می‌شود
```

### یا مستقیم:
```bash
python test_professional_grid.py
```

---

## 📁 فایل‌های مرتبط:

```
app/gui/financial/
├── professional_grid_widget.py          # ویجت اصلی گزارش
└── column_customization_dialog.py       # دیالوگ شخصی‌سازی

data/financial/
└── grid_config.json                     # تنظیمات ذخیره شده

docs/
├── PROFESSIONAL_GRID_GUIDE.md           # راهنمای کامل
└── BUG_FIXES_REPORT.md                  # گزارش رفع خطاها
```

---

## 🔄 جریان کار:

```
┌──────────────────────────────────────────┐
│  1. Import داده‌ها                      │
│     (Smart Import Wizard)                │
└──────────────────┬───────────────────────┘
                   ↓
┌──────────────────────────────────────────┐
│  2. پردازش خودکار                       │
│     (RawData → Account/Sale)             │
└──────────────────┬───────────────────────┘
                   ↓
┌──────────────────────────────────────────┐
│  3. باز کردن گزارش حرفه‌ای              │
│     (تب مدیریت BI)                       │
└──────────────────┬───────────────────────┘
                   ↓
┌──────────────────────────────────────────┐
│  4. شخصی‌سازی (اختیاری)                 │
│     • انتخاب ستون‌ها                    │
│     • افزودن فرمول                      │
│     • ذخیره تنظیمات                     │
└──────────────────┬───────────────────────┘
                   ↓
┌──────────────────────────────────────────┐
│  5. مشاهده گزارش                        │
│     • فیلتر                             │
│     • مرتب‌سازی                         │
│     • جزئیات (Double-click)             │
└──────────────────┬───────────────────────┘
                   ↓
┌──────────────────────────────────────────┐
│  6. خروجی Excel (اختیاری)               │
└──────────────────────────────────────────┘
```

---

## 💡 نکات مهم:

1. **تنظیمات ماندگار**: بعد از ذخیره، دفعات بعد همان تنظیمات اعمال می‌شود

2. **فرمول‌ها هوشمند**: قبل از ذخیره اعتبارسنجی می‌شوند

3. **Platform خودکار**: نیازی به تنظیم دستی نیست

4. **بازگردانی آسان**: در هر لحظه می‌توانید به پیش‌فرض برگردید

5. **خروجی Excel**: تمام ستون‌ها و فرمول‌های سفارشی در Excel ذخیره می‌شوند

---

## 📊 مثال عملی:

**قبل از شخصی‌سازی:**
```
Label | Email | Supplier | Gold | Rate | Cost | ... | Profit
```

**بعد از شخصی‌سازی:**
```
Label | Gold | Cost | Profit | Profit/Gold | Margin% | Roblox | Apple
```

با فرمول‌های سفارشی:
- **Profit/Gold**: `{total_profit} / {gold_purchased}`
- **Margin%**: `({total_revenue} - {purchase_cost}) / {total_revenue} * 100`

---

## ✅ وضعیت نهایی:

- ✅ Professional Grid کامل
- ✅ شخصی‌سازی ستون‌ها
- ✅ ستون‌های Platform
- ✅ فرمول‌های محاسباتی
- ✅ ذخیره/بازیابی تنظیمات
- ✅ خروجی Excel
- ✅ فیلترها
- ✅ راهنمای کامل

---

تاریخ: 2025-12-18  
نسخه: 1.0.0  
وضعیت: ✅ آماده استفاده
