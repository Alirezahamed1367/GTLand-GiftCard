# ğŸ“˜ Ù…Ù†Ø·Ù‚ Ú©Ø§Ù…Ù„ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø¯Ø§Ø¯Ù‡ Ø§Ø² Google Sheets

## ğŸ¯ Ø®Ù„Ø§ØµÙ‡ Ú©Ù„ÛŒ

Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø§Ø² Google Sheets Ø±Ú©ÙˆØ±Ø¯Ù‡Ø§ÛŒÛŒ Ø±Ø§ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ Ú©Ù‡:
1. âœ… Ø³ØªÙˆÙ† "Ready" Ø¢Ù†Ù‡Ø§ TRUE Ø§Ø³Øª (Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³ØªØ®Ø±Ø§Ø¬)
2. âŒ Ø³ØªÙˆÙ† "Extracted" Ø¢Ù†Ù‡Ø§ FALSE Ø§Ø³Øª (Ù‡Ù†ÙˆØ² Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù†Ø´Ø¯Ù‡)

---

## ğŸ“Š Ù…Ø¹Ù…Ø§Ø±ÛŒ Ø³ÛŒØ³ØªÙ… Ø§Ø³ØªØ®Ø±Ø§Ø¬

```
[Google Sheet] 
    â†“ (gspread API)
[GoogleSheetExtractor]
    â†“ (Ù¾Ø±Ø¯Ø§Ø²Ø´)
[Database Manager]
    â†“ (Ø°Ø®ÛŒØ±Ù‡)
[SQLite Database]
```

---

## ğŸ” Ù…Ø±Ø§Ø­Ù„ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø¨Ù‡ ØªÙØµÛŒÙ„

### **Ù…Ø±Ø­Ù„Ù‡ 1: Ø§ØªØµØ§Ù„ Ø¨Ù‡ Google Sheets**

ğŸ“ ÙØ§ÛŒÙ„: `app/core/google_sheets.py`

```python
class GoogleSheetExtractor:
    def __init__(self, credentials_path):
        # Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ credentials.json
        scope = [
            "https://spreadsheets.google.com/feeds",
            "https://www.googleapis.com/auth/drive",
            "https://www.googleapis.com/auth/spreadsheets"
        ]
        creds = Credentials.from_service_account_file(credentials_path, scopes=scope)
        self.client = gspread.authorize(creds)
```

**ØªÙˆØ¶ÛŒØ­:**
- Ø§Ø² Google Service Account Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯
- Ù†ÛŒØ§Ø² Ø¨Ù‡ share Ú©Ø±Ø¯Ù† Ø´ÛŒØª Ø¨Ø§ email Ù…ÙˆØ¬ÙˆØ¯ Ø¯Ø± `credentials.json`

---

### **Ù…Ø±Ø­Ù„Ù‡ 2: Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Worksheet**

```python
def extract_ready_rows(self, sheet_url, worksheet_name, ready_column, extracted_column, ...):
    # 1. Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ø´ÛŒØª Ø¨Ø§ URL
    sheet = self.client.open_by_url(sheet_url)
    
    # 2. Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† worksheet Ø¨Ø§ Ù†Ø§Ù… (case-insensitive)
    for ws in sheet.worksheets():
        if ws.title.lower() == worksheet_name.lower():
            worksheet = ws
            break
    
    # 3. Ø®ÙˆØ§Ù†Ø¯Ù† ØªÙ…Ø§Ù… Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø´ÛŒØª
    all_values = worksheet.get_all_values()
```

**ØªÙˆØ¶ÛŒØ­:**
- `get_all_values()` ØªÙ…Ø§Ù… Ø³Ù„ÙˆÙ„â€ŒÙ‡Ø§ÛŒ Ø´ÛŒØª Ø±Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ù„ÛŒØ³Øª Ø¯Ùˆ Ø¨Ø¹Ø¯ÛŒ Ø¨Ø±Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ø§Ù†Ø¯
- Ø±Ø¯ÛŒÙ Ø§ÙˆÙ„ = Ù‡Ø¯Ø±Ù‡Ø§
- Ø±Ø¯ÛŒÙâ€ŒÙ‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ = Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§

**Ù…Ø«Ø§Ù„:**
```python
all_values = [
    ['Value', 'Label', 'CODE', 'Ready', 'Extracted'],  # Ø±Ø¯ÛŒÙ 1 (Ù‡Ø¯Ø±)
    ['100', 'PUBG', 'ABC123', 'TRUE', 'FALSE'],       # Ø±Ø¯ÛŒÙ 2
    ['200', 'Roblox', 'XYZ789', 'FALSE', 'FALSE'],    # Ø±Ø¯ÛŒÙ 3
]
```

---

### **Ù…Ø±Ø­Ù„Ù‡ 3: Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† Ø³ØªÙˆÙ†â€ŒÙ‡Ø§ÛŒ Ready Ùˆ Extracted**

âš ï¸ **Ø§ÛŒÙ†Ø¬Ø§ Ù…Ø´Ú©Ù„ Ø§ØµÙ„ÛŒ Ø¨ÙˆØ¯!**

#### **Ù…Ù†Ø·Ù‚ Ù‚Ø¯ÛŒÙ…ÛŒ (Ø§Ø´ØªØ¨Ø§Ù‡):**
```python
# Ø§ÙˆÙ„ Ø³Ø¹ÛŒ Ù…ÛŒâ€ŒÚ©Ø±Ø¯ "Ready" Ø±Ø§ Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† Ø­Ø±Ù Ø³ØªÙˆÙ† ØªØ¨Ø¯ÛŒÙ„ Ú©Ù†Ø¯
try:
    ready_col_idx = column_letter_to_index("Ready")  # Ù†ØªÛŒØ¬Ù‡: 8314252 âŒ
except:
    # Ø¨Ù‡ Ø¯Ù†Ø¨Ø§Ù„ Ù†Ø§Ù… Ø³ØªÙˆÙ† Ù…ÛŒâ€ŒÚ¯Ø´Øª
```

#### **Ù…Ù†Ø·Ù‚ Ø¬Ø¯ÛŒØ¯ (ØµØ­ÛŒØ­):**
```python
# Ø§ÙˆÙ„ Ø¨Ù‡ Ø¯Ù†Ø¨Ø§Ù„ Ù†Ø§Ù… Ø³ØªÙˆÙ† Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ø¯
for idx, header in enumerate(headers):
    if header.lower() == "ready":  # Ù¾ÛŒØ¯Ø§ Ø´Ø¯! âœ…
        ready_col_idx = idx
        break

# Ø§Ú¯Ø± Ù¾ÛŒØ¯Ø§ Ù†Ø´Ø¯ØŒ Ø´Ø§ÛŒØ¯ Ø­Ø±Ù Ø³ØªÙˆÙ† Ø¨Ø§Ø´Ø¯ (A, B, C)
if ready_col_idx == -1 and len(ready_column) <= 3:
    ready_col_idx = column_letter_to_index(ready_column)
```

**Ú†Ø±Ø§ Ø§ÛŒÙ† Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯ØŸ**
- Ø§ÙˆÙ„ÙˆÛŒØª Ø¨Ø§ Ù†Ø§Ù… Ø³ØªÙˆÙ† Ø§Ø³Øª
- ÙÙ‚Ø· Ø§Ú¯Ø± Ù†Ø§Ù… Ú©ÙˆØªØ§Ù‡ (â‰¤3 Ø­Ø±Ù) Ùˆ Ø­Ø±Ù Ù…Ø­Ø¶ Ø¨Ø§Ø´Ø¯ØŒ Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† Ø­Ø±Ù Ø³ØªÙˆÙ† ØªÙØ³ÛŒØ± Ù…ÛŒâ€ŒØ´ÙˆØ¯
- Ù…Ø«Ø§Ù„: `"A"` â†’ Ø­Ø±Ù Ø³ØªÙˆÙ†ØŒ `"Ready"` â†’ Ù†Ø§Ù… Ø³ØªÙˆÙ†

---

### **Ù…Ø±Ø­Ù„Ù‡ 4: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø±Ú©ÙˆØ±Ø¯Ù‡Ø§ÛŒ Ø¢Ù…Ø§Ø¯Ù‡**

```python
ready_rows = []

for row_idx, row_values in enumerate(all_values[1:], start=2):
    # Ø¯Ø±ÛŒØ§ÙØª Ù…Ù‚Ø§Ø¯ÛŒØ± Ø³Ù„ÙˆÙ„â€ŒÙ‡Ø§ÛŒ Ready Ùˆ Extracted
    ready_value = row_values[ready_col_idx]
    extracted_value = row_values[extracted_col_idx]
    
    # Ø¨Ø±Ø±Ø³ÛŒ Ø¨Ø§ ØªØ´Ø®ÛŒØµ Ù‡ÙˆØ´Ù…Ù†Ø¯
    is_ready = is_cell_checked(ready_value)
    is_extracted = is_cell_extracted(extracted_value)
    
    # Ø´Ø±Ø· Ø§Ø³ØªØ®Ø±Ø§Ø¬: Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ø§Ø´Ø¯ Ùˆ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù†Ø´Ø¯Ù‡ Ø¨Ø§Ø´Ø¯
    if is_ready and not is_extracted:
        row_data = {}
        for col_idx, col_name in zip(col_indices, col_names):
            row_data[col_name] = row_values[col_idx]
        
        ready_rows.append({
            "row_number": row_idx,
            "data": row_data
        })

return ready_rows
```

**ØªÙˆØ¶ÛŒØ­:**
- `enumerate(all_values[1:], start=2)` â†’ Ø´Ø±ÙˆØ¹ Ø§Ø² Ø±Ø¯ÛŒÙ 2 (Ø¨Ø¹Ø¯ Ø§Ø² Ù‡Ø¯Ø±)
- `is_cell_checked()` â†’ ØªØ´Ø®ÛŒØµ TRUE, âœ“, Yes, 1, Ø¢Ù…Ø§Ø¯Ù‡ØŒ ...
- `is_extracted()` â†’ ØªØ´Ø®ÛŒØµ FALSE, âœ—, No, 0, Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù†Ø´Ø¯Ù‡ØŒ ...

---

### **Ù…Ø±Ø­Ù„Ù‡ 5: ØªØ´Ø®ÛŒØµ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ù…Ù‚Ø§Ø¯ÛŒØ±**

ğŸ“ ÙØ§ÛŒÙ„: `app/utils/cell_status_detector.py`

```python
def is_cell_checked(value: Any) -> bool:
    """
    ØªØ´Ø®ÛŒØµ Ø¢ÛŒØ§ Ø³Ù„ÙˆÙ„ TRUE Ø§Ø³Øª
    """
    str_value = str(value).strip().lower()
    
    # Ù…Ù‚Ø§Ø¯ÛŒØ± Ù…Ø«Ø¨Øª
    positive_values = [
        "true", "yes", "y", "ok", "done", "completed", "ready", "active",
        "âœ“", "âœ”", "â˜‘", "âœ…", "1", "Ø¢Ù…Ø§Ø¯Ù‡", "Ø¨Ù„Ù‡", "Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯Ù‡"
    ]
    
    if str_value in positive_values:
        return True
    
    # Checkbox Ø¯Ø± Ú¯ÙˆÚ¯Ù„ Ø´ÛŒØª Ø¨Ù‡ ØµÙˆØ±Øª TRUE/FALSE Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
    if value is True or str_value == 'true':
        return True
    
    return False

def is_cell_extracted(value: Any) -> bool:
    """
    ØªØ´Ø®ÛŒØµ Ø¢ÛŒØ§ Ø³Ù„ÙˆÙ„ "Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø´Ø¯Ù‡" Ø§Ø³Øª
    """
    str_value = str(value).strip().lower()
    
    # Ø§Ú¯Ø± Extracted Ø¨Ø§Ø´Ø¯ (Ù…Ø«Ø¨Øª)
    extracted_values = [
        "extracted", "done", "completed", "âœ…", "true",
        "Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø´Ø¯Ù‡", "Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯"
    ]
    
    return str_value in extracted_values
```

**Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§:**

| Ù…Ù‚Ø¯Ø§Ø± Ø¯Ø± Ø´ÛŒØª | `is_cell_checked()` | `is_cell_extracted()` |
|---------------|---------------------|----------------------|
| âœ“ (checkbox checked) | âœ… TRUE | âŒ FALSE |
| TRUE | âœ… TRUE | âŒ FALSE |
| FALSE | âŒ FALSE | âŒ FALSE |
| (Ø®Ø§Ù„ÛŒ) | âŒ FALSE | âŒ FALSE |
| Extracted | âŒ FALSE | âœ… TRUE |
| âœ… | âœ… TRUE | âœ… TRUE |

---

### **Ù…Ø±Ø­Ù„Ù‡ 6: Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± Ø¯ÛŒØªØ§Ø¨ÛŒØ³**

ğŸ“ ÙØ§ÛŒÙ„: `app/core/database.py`

```python
def save_sales_data(self, sheet_config_id, row_number, unique_key, data, update_if_exists):
    """
    Ø°Ø®ÛŒØ±Ù‡ ÛŒÚ© Ø±Ú©ÙˆØ±Ø¯
    """
    # Ø¨Ø±Ø±Ø³ÛŒ ØªÚ©Ø±Ø§Ø±ÛŒ Ø¨ÙˆØ¯Ù†
    existing = db.query(SalesData).filter_by(unique_key=unique_key).first()
    
    if existing:
        if update_if_exists:
            # Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø±Ú©ÙˆØ±Ø¯ Ù…ÙˆØ¬ÙˆØ¯
            for key, value in data.items():
                setattr(existing, key, value)
            is_duplicate = True
        else:
            # Ø±Ø¯ Ú©Ø±Ø¯Ù† (duplicate)
            return (True, existing, True, "Ø±Ú©ÙˆØ±Ø¯ ØªÚ©Ø±Ø§Ø±ÛŒ")
    else:
        # Ø§ÛŒØ¬Ø§Ø¯ Ø±Ú©ÙˆØ±Ø¯ Ø¬Ø¯ÛŒØ¯
        new_record = SalesData(
            sheet_config_id=sheet_config_id,
            row_number=row_number,
            unique_key=unique_key,
            extracted_at=datetime.now(),
            is_exported=False,
            **data
        )
        db.add(new_record)
    
    db.commit()
    return (True, record, is_duplicate, "Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯")
```

---

### **Ù…Ø±Ø­Ù„Ù‡ 7: Ø¹Ù„Ø§Ù…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† "Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø´Ø¯Ù‡"**

```python
def mark_rows_as_extracted(self, sheet_url, worksheet_name, row_numbers, extracted_column):
    """
    Ø¹Ù„Ø§Ù…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ú†Ù†Ø¯ Ø±Ø¯ÛŒÙ Ø¨Ù‡ ØµÙˆØ±Øª ÛŒÚ©Ø¬Ø§
    """
    worksheet = sheet.worksheet(worksheet_name)
    
    # ØªØ¨Ø¯ÛŒÙ„ Ù†Ø§Ù… Ø³ØªÙˆÙ† Ø¨Ù‡ index (Ø¨Ø§ Ù…Ù†Ø·Ù‚ Ø¬Ø¯ÛŒØ¯)
    headers = worksheet.row_values(1)
    extracted_col_idx = headers.index(extracted_column.strip()) + 1  # +1 Ø¨Ø±Ø§ÛŒ gspread
    
    # Ø³Ø§Ø®Øª batch update
    updates = []
    for row_num in row_numbers:
        cell = gspread.utils.rowcol_to_a1(row_num, extracted_col_idx)
        updates.append({
            'range': cell,
            'values': [['TRUE']]  # ÛŒØ§ 'Extracted' ÛŒØ§ 'âœ…'
        })
    
    # Ø§Ø±Ø³Ø§Ù„ ÛŒÚ©Ø¬Ø§ Ø¨Ù‡ Ú¯ÙˆÚ¯Ù„ Ø´ÛŒØª
    worksheet.batch_update(updates)
```

**Ú†Ø±Ø§ Batch UpdateØŸ**
- Ú©Ø§Ù‡Ø´ ØªØ¹Ø¯Ø§Ø¯ API calls
- Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Rate Limiting
- Ø³Ø±Ø¹Øª Ø¨ÛŒØ´ØªØ± (50 Ø±Ú©ÙˆØ±Ø¯ = 1 API call Ø¨Ù‡ Ø¬Ø§ÛŒ 50)

---

## ğŸ”„ ÙÙ„ÙˆÚ†Ø§Ø±Øª Ú©Ø§Ù…Ù„ Ø§Ø³ØªØ®Ø±Ø§Ø¬

```
START
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ú©Ø§Ø±Ø¨Ø± Ø¯Ú©Ù…Ù‡ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…ÛŒâ€ŒØ²Ù†Ø¯ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ø®ÙˆØ§Ù†Ø¯Ù† ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø´ÛŒØª Ø§Ø² Ø¯ÛŒØªØ§Ø¨ÛŒØ³     â”‚
â”‚ - sheet_url                        â”‚
â”‚ - worksheet_name                   â”‚
â”‚ - ready_column                     â”‚
â”‚ - extracted_column                 â”‚
â”‚ - columns_to_extract               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ø§ØªØµØ§Ù„ Ø¨Ù‡ Google Sheets             â”‚
â”‚ Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† worksheet                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ø®ÙˆØ§Ù†Ø¯Ù† ØªÙ…Ø§Ù… Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§                â”‚
â”‚ all_values = worksheet.get_all_values() â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† index Ø³ØªÙˆÙ† Ready         â”‚
â”‚ (Ø§ÙˆÙ„ Ù†Ø§Ù…ØŒ Ø¨Ø¹Ø¯ Ø­Ø±Ù)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† index Ø³ØªÙˆÙ† Extracted     â”‚
â”‚ (Ø§ÙˆÙ„ Ù†Ø§Ù…ØŒ Ø¨Ø¹Ø¯ Ø­Ø±Ù)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ø­Ù„Ù‚Ù‡ Ø±ÙˆÛŒ ØªÙ…Ø§Ù… Ø±Ø¯ÛŒÙâ€ŒÙ‡Ø§              â”‚
â”‚ (Ø§Ø² Ø±Ø¯ÛŒÙ 2 Ø¨Ù‡ Ø¨Ø¹Ø¯)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Ø®ÙˆØ§Ù†Ø¯Ù† Ù…Ù‚Ø¯Ø§Ø± Ready     â”‚
  â”‚ Ø®ÙˆØ§Ù†Ø¯Ù† Ù…Ù‚Ø¯Ø§Ø± Extracted â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ is_ready = is_cell_checked(ready_value)      â”‚
    â”‚ is_extracted = is_cell_extracted(extracted_value) â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â†“
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ if is_ready and not is_extracted: â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“ Ø¨Ù„Ù‡
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Ø³Ø§Ø®Øª unique_key             â”‚
        â”‚ Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø³ØªÙˆÙ†â€ŒÙ‡Ø§  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚ Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± Ø¯ÛŒØªØ§Ø¨ÛŒØ³           â”‚
          â”‚ (Ø¨Ø§ Ø¨Ø±Ø±Ø³ÛŒ duplicate)        â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Ø§Ø¶Ø§ÙÙ‡ Ø¨Ù‡ Ù„ÛŒØ³Øª Ø¹Ù„Ø§Ù…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ù¾Ø§ÛŒØ§Ù† Ø­Ù„Ù‚Ù‡                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ø¹Ù„Ø§Ù…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ø±Ú©ÙˆØ±Ø¯Ù‡Ø§ Ø¯Ø± Ø´ÛŒØª         â”‚
â”‚ (Batch Update)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ù†Ù…Ø§ÛŒØ´ Ù†ØªÛŒØ¬Ù‡ Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø±               â”‚
â”‚ - ØªØ¹Ø¯Ø§Ø¯ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø´Ø¯Ù‡                â”‚
â”‚ - ØªØ¹Ø¯Ø§Ø¯ ØªÚ©Ø±Ø§Ø±ÛŒ                      â”‚
â”‚ - ØªØ¹Ø¯Ø§Ø¯ Ø®Ø·Ø§                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
END
```

---

## ğŸ› Ù…Ø´Ú©Ù„ Ù‚Ø¨Ù„ÛŒ Ùˆ Ø±Ø§Ù‡ Ø­Ù„

### âŒ **Ú©Ø¯ Ù‚Ø¯ÛŒÙ…ÛŒ:**
```python
# Ø§Ø´ØªØ¨Ø§Ù‡: Ø§ÙˆÙ„ Ø³Ø¹ÛŒ Ù…ÛŒâ€ŒÚ©Ø±Ø¯ "Ready" Ø±Ø§ ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ Ø¹Ø¯Ø¯ Ú©Ù†Ø¯
try:
    ready_col_idx = column_letter_to_index("Ready")
    # Ù†ØªÛŒØ¬Ù‡: 8314252 (Ø§Ø´ØªØ¨Ø§Ù‡!)
except:
    # Ø§ÛŒÙ† Ø®Ø· Ù‡Ø±Ú¯Ø² Ø§Ø¬Ø±Ø§ Ù†Ù…ÛŒâ€ŒØ´Ø¯
    ready_col_idx = headers.index("Ready")
```

**Ú†Ø±Ø§ Ø§Ø´ØªØ¨Ø§Ù‡ Ø¨ÙˆØ¯?**
- `column_letter_to_index("Ready")` Ù‡Ù…ÛŒØ´Ù‡ Ù…ÙˆÙÙ‚ Ù…ÛŒâ€ŒØ´Ø¯
- "Ready" Ø±Ø§ Ù…Ø«Ù„ "ABCDE" Ù…ÛŒâ€ŒØ®ÙˆØ§Ù†Ø¯ Ùˆ ØªØ¨Ø¯ÛŒÙ„ Ù…ÛŒâ€ŒÚ©Ø±Ø¯
- Ù…Ø­Ø§Ø³Ø¨Ù‡: R=18, E=5, A=1, D=4, Y=25
- Ù†ØªÛŒØ¬Ù‡: 18Ã—26â´ + 5Ã—26Â³ + 1Ã—26Â² + 4Ã—26Â¹ + 25 = 8314252

### âœ… **Ú©Ø¯ Ø¬Ø¯ÛŒØ¯:**
```python
# ØµØ­ÛŒØ­: Ø§ÙˆÙ„ Ù†Ø§Ù… Ø³ØªÙˆÙ† Ø±Ø§ Ú†Ú© Ù…ÛŒâ€ŒÚ©Ù†Ø¯
for idx, header in enumerate(headers):
    if header.strip().lower() == "ready":
        ready_col_idx = idx  # Ù†ØªÛŒØ¬Ù‡: 16 (ØµØ­ÛŒØ­!)
        break

# ÙÙ‚Ø· Ø§Ú¯Ø± Ù†ÛŒØ§ÙØª Ùˆ Ù†Ø§Ù… Ú©ÙˆØªØ§Ù‡ Ø¨ÙˆØ¯ØŒ Ø­Ø±Ù Ø³ØªÙˆÙ† Ø¯Ø± Ù†Ø¸Ø± Ù…ÛŒâ€ŒÚ¯ÛŒØ±Ø¯
if ready_col_idx == -1 and len(ready_column) <= 3:
    ready_col_idx = column_letter_to_index(ready_column)
```

---

## ğŸ“ ØªÙ†Ø¸ÛŒÙ…Ø§Øª ØªÙˆØµÛŒÙ‡ Ø´Ø¯Ù‡

### **Ù†Ø§Ù… Ø³ØªÙˆÙ†â€ŒÙ‡Ø§ Ø¯Ø± Google Sheet:**
```
| Value | Label | CODE | Ready | Extracted |
```

### **ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¯Ø± Ø¨Ø±Ù†Ø§Ù…Ù‡:**
```
Ø³ØªÙˆÙ† Ø¢Ù…Ø§Ø¯Ù‡: Ready
Ø³ØªÙˆÙ† Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø´Ø¯Ù‡: Extracted
```

### **Ø§Ù†ÙˆØ§Ø¹ Ù…Ù‚Ø§Ø¯ÛŒØ± Ù…Ø¬Ø§Ø²:**

**Ø¨Ø±Ø§ÛŒ Ø³ØªÙˆÙ† Ready:**
- âœ“ (checkbox checked Ø¯Ø± Ú¯ÙˆÚ¯Ù„ Ø´ÛŒØª)
- TRUE
- Yes / Y
- 1
- Ø¢Ù…Ø§Ø¯Ù‡
- Done
- âœ…

**Ø¨Ø±Ø§ÛŒ Ø³ØªÙˆÙ† Extracted:**
- Extracted
- TRUE  
- Done
- âœ…
- Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø´Ø¯Ù‡

---

## ğŸ§ª ØªØ³Øª Ú©Ø±Ø¯Ù†

### **ØªØ³Øª 1: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø³Ø§Ø¯Ù‡**
1. Ø¯Ø± Ú¯ÙˆÚ¯Ù„ Ø´ÛŒØªØŒ ÛŒÚ© Ø±Ø¯ÛŒÙ Ø±Ø§ Ø¢Ù…Ø§Ø¯Ù‡ Ú©Ù†ÛŒØ¯:
   - Ready: âœ“
   - Extracted: (Ø®Ø§Ù„ÛŒ)
2. Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ú©Ù†ÛŒØ¯
3. Ù†ØªÛŒØ¬Ù‡: Ø¨Ø§ÛŒØ¯ Ø±Ú©ÙˆØ±Ø¯ Ø¯Ø± Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ø°Ø®ÛŒØ±Ù‡ Ø´ÙˆØ¯

### **ØªØ³Øª 2: Ø±Ú©ÙˆØ±Ø¯ ØªÚ©Ø±Ø§Ø±ÛŒ**
1. Ù‡Ù…Ø§Ù† Ø±Ú©ÙˆØ±Ø¯ Ø±Ø§ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ú©Ù†ÛŒØ¯
2. Ù†ØªÛŒØ¬Ù‡: Ø¨Ø§ÛŒØ¯ Ù¾ÛŒØ§Ù… "Ø±Ú©ÙˆØ±Ø¯ ØªÚ©Ø±Ø§Ø±ÛŒ" Ù†Ù…Ø§ÛŒØ´ Ø¯Ù‡Ø¯

### **ØªØ³Øª 3: Ø¹Ù„Ø§Ù…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ**
1. Ø¨Ø¹Ø¯ Ø§Ø² Ø§Ø³ØªØ®Ø±Ø§Ø¬ØŒ Ø´ÛŒØª Ø±Ø§ refresh Ú©Ù†ÛŒØ¯
2. Ù†ØªÛŒØ¬Ù‡: Ø³ØªÙˆÙ† Extracted Ø¨Ø§ÛŒØ¯ TRUE Ø´ÙˆØ¯

---

## ğŸ” Ù„Ø§Ú¯â€ŒÙ‡Ø§ÛŒ Ù…Ù‡Ù…

```
âœ… Ø³ØªÙˆÙ† Ø¢Ù…Ø§Ø¯Ù‡ Ù¾ÛŒØ¯Ø§ Ø´Ø¯ Ø¨Ø§ Ù†Ø§Ù…: 'Ready' (index 16)
âœ… Ø³ØªÙˆÙ† Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù¾ÛŒØ¯Ø§ Ø´Ø¯ Ø¨Ø§ Ù†Ø§Ù…: 'Extracted' (index 17)
 25 Ø±Ø¯ÛŒÙ Ø¢Ù…Ø§Ø¯Ù‡ ÛŒØ§ÙØª Ø´Ø¯
```

Ø§Ú¯Ø± Ø§ÛŒÙ† Ù„Ø§Ú¯â€ŒÙ‡Ø§ Ø±Ø§ Ø¯ÛŒØ¯ÛŒØ¯ØŒ ÛŒØ¹Ù†ÛŒ Ø³ÛŒØ³ØªÙ… Ø¨Ù‡ Ø¯Ø±Ø³ØªÛŒ Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯! âœ…

---

**ØªÙˆØ³Ø¹Ù‡ Ø¯Ù‡Ù†Ø¯Ù‡:** Ø¹Ù„ÛŒØ±Ø¶Ø§ Ø­Ø§Ù…Ø¯  
**ØªØ§Ø±ÛŒØ®:** 2025/11/12
